var requirejs,require,define;!function(global){function isFunction(a){return"[object Function]"===ostring.call(a)}function isArray(a){return"[object Array]"===ostring.call(a)}function each(a,b){if(a){var c;for(c=0;c<a.length&&(!a[c]||!b(a[c],c,a));c+=1);}}function eachReverse(a,b){if(a){var c;for(c=a.length-1;c>-1&&(!a[c]||!b(a[c],c,a));c-=1);}}function hasProp(a,b){return hasOwn.call(a,b)}function getOwn(a,b){return hasProp(a,b)&&a[b]}function eachProp(a,b){var c;for(c in a)if(hasProp(a,c)&&b(a[c],c))break}function mixin(a,b,c,d){return b&&eachProp(b,function(b,e){!c&&hasProp(a,e)||(!d||"object"!=typeof b||!b||isArray(b)||isFunction(b)||b instanceof RegExp?a[e]=b:(a[e]||(a[e]={}),mixin(a[e],b,c,d)))}),a}function bind(a,b){return function(){return b.apply(a,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(a){throw a}function getGlobal(a){if(!a)return a;var b=global;return each(a.split("."),function(a){b=b[a]}),b}function makeError(a,b,c,d){var e=new Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a);return e.requireType=a,e.requireModules=d,c&&(e.originalError=c),e}function newContext(a){function b(a){var b,c,d=a.length;for(b=0;d>b;b++)if(c=a[b],"."===c)a.splice(b,1),b-=1;else if(".."===c){if(1===b&&(".."===a[2]||".."===a[0]))break;b>0&&(a.splice(b-1,2),b-=2)}}function c(a,c,d){var e,f,g,h,i,j,k,l,m,n,o,p=c&&c.split("/"),q=p,r=x.map,s=r&&r["*"];if(a&&"."===a.charAt(0)&&(c?(q=p.slice(0,p.length-1),a=a.split("/"),k=a.length-1,x.nodeIdCompat&&jsSuffixRegExp.test(a[k])&&(a[k]=a[k].replace(jsSuffixRegExp,"")),a=q.concat(a),b(a),a=a.join("/")):0===a.indexOf("./")&&(a=a.substring(2))),d&&r&&(p||s)){g=a.split("/");a:for(h=g.length;h>0;h-=1){if(j=g.slice(0,h).join("/"),p)for(i=p.length;i>0;i-=1)if(f=getOwn(r,p.slice(0,i).join("/")),f&&(f=getOwn(f,j))){l=f,m=h;break a}!n&&s&&getOwn(s,j)&&(n=getOwn(s,j),o=h)}!l&&n&&(l=n,m=o),l&&(g.splice(0,m,l),a=g.join("/"))}return e=getOwn(x.pkgs,a),e?e:a}function d(a){isBrowser&&each(scripts(),function(b){return b.getAttribute("data-requiremodule")===a&&b.getAttribute("data-requirecontext")===u.contextName?(b.parentNode.removeChild(b),!0):void 0})}function e(a){var b=getOwn(x.paths,a);return b&&isArray(b)&&b.length>1?(b.shift(),u.require.undef(a),u.require([a]),!0):void 0}function f(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function g(a,b,d,e){var g,h,i,j,k=null,l=b?b.name:null,m=a,n=!0,o="";return a||(n=!1,a="_@r"+(F+=1)),j=f(a),k=j[0],a=j[1],k&&(k=c(k,l,e),h=getOwn(C,k)),a&&(k?o=h&&h.normalize?h.normalize(a,function(a){return c(a,l,e)}):c(a,l,e):(o=c(a,l,e),j=f(o),k=j[0],o=j[1],d=!0,g=u.nameToUrl(o))),i=!k||h||d?"":"_unnormalized"+(G+=1),{prefix:k,name:o,parentMap:b,unnormalized:!!i,url:g,originalName:m,isDefine:n,id:(k?k+"!"+o:o)+i}}function h(a){var b=a.id,c=getOwn(y,b);return c||(c=y[b]=new u.Module(a)),c}function i(a,b,c){var d=a.id,e=getOwn(y,d);!hasProp(C,d)||e&&!e.defineEmitComplete?(e=h(a),e.error&&"error"===b?c(e.error):e.on(b,c)):"defined"===b&&c(C[d])}function j(a,b){var c=a.requireModules,d=!1;b?b(a):(each(c,function(b){var c=getOwn(y,b);c&&(c.error=a,c.events.error&&(d=!0,c.emit("error",a)))}),d||req.onError(a))}function k(){globalDefQueue.length&&(apsp.apply(B,[B.length,0].concat(globalDefQueue)),globalDefQueue=[])}function l(a){delete y[a],delete z[a]}function m(a,b,c){var d=a.map.id;a.error?a.emit("error",a.error):(b[d]=!0,each(a.depMaps,function(d,e){var f=d.id,g=getOwn(y,f);!g||a.depMatched[e]||c[f]||(getOwn(b,f)?(a.defineDep(e,C[f]),a.check()):m(g,b,c))}),c[d]=!0)}function n(){var a,b,c=1e3*x.waitSeconds,f=c&&u.startTime+c<(new Date).getTime(),g=[],h=[],i=!1,k=!0;if(!s){if(s=!0,eachProp(z,function(a){var c=a.map,j=c.id;if(a.enabled&&(c.isDefine||h.push(a),!a.error))if(!a.inited&&f)e(j)?(b=!0,i=!0):(g.push(j),d(j));else if(!a.inited&&a.fetched&&c.isDefine&&(i=!0,!c.prefix))return k=!1}),f&&g.length)return a=makeError("timeout","Load timeout for modules: "+g,null,g),a.contextName=u.contextName,j(a);k&&each(h,function(a){m(a,{},{})}),f&&!b||!i||!isBrowser&&!isWebWorker||w||(w=setTimeout(function(){w=0,n()},50)),s=!1}}function o(a){hasProp(C,a[0])||h(g(a[0],null,!0)).init(a[1],a[2])}function p(a,b,c,d){a.detachEvent&&!isOpera?d&&a.detachEvent(d,b):a.removeEventListener(c,b,!1)}function q(a){var b=a.currentTarget||a.srcElement;return p(b,u.onScriptLoad,"load","onreadystatechange"),p(b,u.onScriptError,"error"),{node:b,id:b&&b.getAttribute("data-requiremodule")}}function r(){var a;for(k();B.length;){if(a=B.shift(),null===a[0])return j(makeError("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));o(a)}}var s,t,u,v,w,x={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},y={},z={},A={},B=[],C={},D={},E={},F=1,G=1;return v={require:function(a){return a.require?a.require:a.require=u.makeRequire(a.map)},exports:function(a){return a.usingExports=!0,a.map.isDefine?a.exports?a.exports:a.exports=C[a.map.id]={}:void 0},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){return getOwn(x.config,a.map.id)||{}},exports:v.exports(a)}}},t=function(a){this.events=getOwn(A,a.id)||{},this.map=a,this.shim=getOwn(x.shim,a.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},t.prototype={init:function(a,b,c,d){d=d||{},this.inited||(this.factory=b,c?this.on("error",c):this.events.error&&(c=bind(this,function(a){this.emit("error",a)})),this.depMaps=a&&a.slice(0),this.errback=c,this.inited=!0,this.ignore=d.ignore,d.enabled||this.enabled?this.enable():this.check())},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0,u.startTime=(new Date).getTime();var a=this.map;return this.shim?void u.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return a.prefix?this.callPlugin():this.load()})):a.prefix?this.callPlugin():this.load()}},load:function(){var a=this.map.url;D[a]||(D[a]=!0,u.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,b,c=this.map.id,d=this.depExports,e=this.exports,f=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(f)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{e=u.execCb(c,f,d,e)}catch(g){a=g}else e=u.execCb(c,f,d,e);if(this.map.isDefine&&void 0===e&&(b=this.module,b?e=b.exports:this.usingExports&&(e=this.exports)),a)return a.requireMap=this.map,a.requireModules=this.map.isDefine?[this.map.id]:null,a.requireType=this.map.isDefine?"define":"require",j(this.error=a)}else e=f;this.exports=e,this.map.isDefine&&!this.ignore&&(C[c]=e,req.onResourceLoad&&req.onResourceLoad(u,this.map,this.depMaps)),l(c),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var a=this.map,b=a.id,d=g(a.prefix);this.depMaps.push(d),i(d,"defined",bind(this,function(d){var e,f,k,m=getOwn(E,this.map.id),n=this.map.name,o=this.map.parentMap?this.map.parentMap.name:null,p=u.makeRequire(a.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(d.normalize&&(n=d.normalize(n,function(a){return c(a,o,!0)})||""),f=g(a.prefix+"!"+n,this.map.parentMap),i(f,"defined",bind(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),k=getOwn(y,f.id),void(k&&(this.depMaps.push(f),this.events.error&&k.on("error",bind(this,function(a){this.emit("error",a)})),k.enable()))):m?(this.map.url=u.nameToUrl(m),void this.load()):(e=bind(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),e.error=bind(this,function(a){this.inited=!0,this.error=a,a.requireModules=[b],eachProp(y,function(a){0===a.map.id.indexOf(b+"_unnormalized")&&l(a.map.id)}),j(a)}),e.fromText=bind(this,function(c,d){var f=a.name,i=g(f),k=useInteractive;d&&(c=d),k&&(useInteractive=!1),h(i),hasProp(x.config,b)&&(x.config[f]=x.config[b]);try{req.exec(c)}catch(l){return j(makeError("fromtexteval","fromText eval for "+b+" failed: "+l,l,[b]))}k&&(useInteractive=!0),this.depMaps.push(i),u.completeLoad(f),p([f],e)}),void d.load(a.name,p,e,x))})),u.enable(d,this),this.pluginMaps[d.id]=d},enable:function(){z[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(a,b){var c,d,e;if("string"==typeof a){if(a=g(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[b]=a,e=getOwn(v,a.id))return void(this.depExports[b]=e(this));this.depCount+=1,i(a,"defined",bind(this,function(a){this.defineDep(b,a),this.check()})),this.errback&&i(a,"error",bind(this,this.errback))}c=a.id,d=y[c],hasProp(v,c)||!d||d.enabled||u.enable(a,this)})),eachProp(this.pluginMaps,bind(this,function(a){var b=getOwn(y,a.id);b&&!b.enabled&&u.enable(a,this)})),this.enabling=!1,this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]),c.push(b)},emit:function(a,b){each(this.events[a],function(a){a(b)}),"error"===a&&delete this.events[a]}},u={config:x,contextName:a,registry:y,defined:C,urlFetched:D,defQueue:B,Module:t,makeModuleMap:g,nextTick:req.nextTick,onError:j,configure:function(a){a.baseUrl&&"/"!==a.baseUrl.charAt(a.baseUrl.length-1)&&(a.baseUrl+="/");var b=x.shim,c={paths:!0,bundles:!0,config:!0,map:!0};eachProp(a,function(a,b){c[b]?(x[b]||(x[b]={}),mixin(x[b],a,!0,!0)):x[b]=a}),a.bundles&&eachProp(a.bundles,function(a,b){each(a,function(a){a!==b&&(E[a]=b)})}),a.shim&&(eachProp(a.shim,function(a,c){isArray(a)&&(a={deps:a}),!a.exports&&!a.init||a.exportsFn||(a.exportsFn=u.makeShimExports(a)),b[c]=a}),x.shim=b),a.packages&&each(a.packages,function(a){var b,c;a="string"==typeof a?{name:a}:a,c=a.name,b=a.location,b&&(x.paths[c]=a.location),x.pkgs[c]=a.name+"/"+(a.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(y,function(a,b){a.inited||a.map.unnormalized||(a.map=g(b))}),(a.deps||a.callback)&&u.require(a.deps||[],a.callback)},makeShimExports:function(a){function b(){var b;return a.init&&(b=a.init.apply(global,arguments)),b||a.exports&&getGlobal(a.exports)}return b},makeRequire:function(b,e){function f(c,d,i){var k,l,m;return e.enableBuildCallback&&d&&isFunction(d)&&(d.__requireJsBuild=!0),"string"==typeof c?isFunction(d)?j(makeError("requireargs","Invalid require call"),i):b&&hasProp(v,c)?v[c](y[b.id]):req.get?req.get(u,c,b,f):(l=g(c,b,!1,!0),k=l.id,hasProp(C,k)?C[k]:j(makeError("notloaded",'Module name "'+k+'" has not been loaded yet for context: '+a+(b?"":". Use require([])")))):(r(),u.nextTick(function(){r(),m=h(g(null,b)),m.skipMap=e.skipMap,m.init(c,d,i,{enabled:!0}),n()}),f)}return e=e||{},mixin(f,{isBrowser:isBrowser,toUrl:function(a){var d,e=a.lastIndexOf("."),f=a.split("/")[0],g="."===f||".."===f;return-1!==e&&(!g||e>1)&&(d=a.substring(e,a.length),a=a.substring(0,e)),u.nameToUrl(c(a,b&&b.id,!0),d,!0)},defined:function(a){return hasProp(C,g(a,b,!1,!0).id)},specified:function(a){return a=g(a,b,!1,!0).id,hasProp(C,a)||hasProp(y,a)}}),b||(f.undef=function(a){k();var c=g(a,b,!0),e=getOwn(y,a);d(a),delete C[a],delete D[c.url],delete A[a],eachReverse(B,function(b,c){b[0]===a&&B.splice(c,1)}),e&&(e.events.defined&&(A[a]=e.events),l(a))}),f},enable:function(a){var b=getOwn(y,a.id);b&&h(a).enable()},completeLoad:function(a){var b,c,d,f=getOwn(x.shim,a)||{},g=f.exports;for(k();B.length;){if(c=B.shift(),null===c[0]){if(c[0]=a,b)break;b=!0}else c[0]===a&&(b=!0);o(c)}if(d=getOwn(y,a),!b&&!hasProp(C,a)&&d&&!d.inited){if(!(!x.enforceDefine||g&&getGlobal(g)))return e(a)?void 0:j(makeError("nodefine","No define call for "+a,null,[a]));o([a,f.deps||[],f.exportsFn])}n()},nameToUrl:function(a,b,c){var d,e,f,g,h,i,j,k=getOwn(x.pkgs,a);if(k&&(a=k),j=getOwn(E,a))return u.nameToUrl(j,b,c);if(req.jsExtRegExp.test(a))h=a+(b||"");else{for(d=x.paths,e=a.split("/"),f=e.length;f>0;f-=1)if(g=e.slice(0,f).join("/"),i=getOwn(d,g)){isArray(i)&&(i=i[0]),e.splice(0,f,i);break}h=e.join("/"),h+=b||(/^data\:|\?/.test(h)||c?"":".js"),h=("/"===h.charAt(0)||h.match(/^[\w\+\.\-]+:/)?"":x.baseUrl)+h}return x.urlArgs?h+((-1===h.indexOf("?")?"?":"&")+x.urlArgs):h},load:function(a,b){req.load(u,a,b)},execCb:function(a,b,c,d){return b.apply(d,c)},onScriptLoad:function(a){if("load"===a.type||readyRegExp.test((a.currentTarget||a.srcElement).readyState)){interactiveScript=null;var b=q(a);u.completeLoad(b.id)}},onScriptError:function(a){var b=q(a);return e(b.id)?void 0:j(makeError("scripterror","Script error for: "+b.id,a,[b.id]))}},u.require=u.makeRequire(),u}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(a){return"interactive"===a.readyState?interactiveScript=a:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.10",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(a,b,c,d){var e,f,g=defContextName;return isArray(a)||"string"==typeof a||(f=a,isArray(b)?(a=b,b=c,c=d):a=[]),f&&f.context&&(g=f.context),e=getOwn(contexts,g),e||(e=contexts[g]=req.s.newContext(g)),f&&e.configure(f),e.require(a,b,c)},req.config=function(a){return req(a)},req.nextTick="undefined"!=typeof setTimeout?function(a){setTimeout(a,4)}:function(a){a()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(a){req[a]=function(){var b=contexts[defContextName];return b.require[a].apply(b,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(a,b,c){var d=a.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return d.type=a.scriptType||"text/javascript",d.charset="utf-8",d.async=!0,d},req.load=function(a,b,c){var d,e=a&&a.config||{};if(isBrowser)return d=req.createNode(e,b,c),d.setAttribute("data-requirecontext",a.contextName),d.setAttribute("data-requiremodule",b),!d.attachEvent||d.attachEvent.toString&&d.attachEvent.toString().indexOf("[native code")<0||isOpera?(d.addEventListener("load",a.onScriptLoad,!1),d.addEventListener("error",a.onScriptError,!1)):(useInteractive=!0,d.attachEvent("onreadystatechange",a.onScriptLoad)),d.src=c,currentlyAddingScript=d,baseElement?head.insertBefore(d,baseElement):head.appendChild(d),currentlyAddingScript=null,d;if(isWebWorker)try{importScripts(c),a.completeLoad(b)}catch(f){a.onError(makeError("importscripts","importScripts failed for "+b+" at "+c,f,[b]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(a){return head||(head=a.parentNode),dataMain=a.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(a,b,c){var d,e;"string"!=typeof a&&(c=b,b=a,a=null),isArray(b)||(c=b,b=null),!b&&isFunction(c)&&(b=[],c.length&&(c.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(a,c){b.push(c)}),b=(1===c.length?["require"]:["require","exports","module"]).concat(b))),useInteractive&&(d=currentlyAddingScript||getInteractiveScript(),d&&(a||(a=d.getAttribute("data-requiremodule")),e=contexts[d.getAttribute("data-requirecontext")])),(e?e.defQueue:globalDefQueue).push([a,b,c])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("views/viewManager",["require","backbone"],function(a){"use strict";function b(a){null!==d&&d.hide(),d=a}var c=a("backbone"),d=null,e=c.View.extend({addViews:function(a){for(var b=0;b<a.length;b++)$(document.body).append(a[b].el),a[b].hide(),this.bindShowEvent(a[b])},bindShowEvent:function(a){this.listenTo(a,"show",function(a){b(a)})}});return new e}),define("tmpl/main",[],function(){return function(a){"use strict";function b(a,b,c){if(c)for(var d in b)"function"==typeof b[d]&&b[d].param&&(b[d]=b[d]());return a.call(h,b)}var c,d,e,f,g,h=this,i="",j=[],k="",l={};if(g="undefined"==typeof __fest_error?"undefined"!=typeof console&&console.error?function(){return Function.prototype.apply.call(console.error,console,arguments)}:function(){}:__fest_error,i+='<div class="main"><dl class="main__menu js-main__menu"><dt class="main__stripe js-main__stripe">Multi Game</dt><dd class="main__field js-main__field"><a class="main__btn btn" href="#game">Start</a></dd><dt class="main__stripe js-main__stripe">Single Game</dt><dd class="main__field js-main__field"><a class="main__btn btn" href="#singleGame">Start</a></dd><dt class="main__stripe js-main__stripe">Scoreboard</dt><dd class="main__field js-main__field"><a class="main__btn btn" href="#scoreboard">Top scores</a></dd><dt class="main__stripe js-main__stripe js-logout-header">Log out</dt><dd class="main__field js-main__field"><a class="main__btn btn js-main__btn_logout">Logout</a></dd><dt class="main__stripe js-main__stripe js-login-header">Login</dt><dd class="main__field js-main__field"><form class="main__form js-main__form_login"><div class="input-field"><label class="input-field__label" for="username">Login</label><div><input class="input-field__input form-control js-input_login_login" type="text" name="username" placeholder="Your login"/></div></div><div class="input-field"><label class="input-field__label" for="password">Password</label><div><input class="input-field__input form-control js-input_login_password" type="password" name="password" placeholder="Your password"/></div></div><div><button class="main__btn btn" type="submit">Login!</button></div></form></dd><dt class="main__stripe js-main__stripe js-signup-header">Sign up</dt><dd class="main__field js-main__field"><form class="main__form js-main__form_signup"><div class="input-field"><label class="input-field__label" for="email">Email</label><div><input class="input-field__input form-control js-input_signup_email" type="text" name="signupEmail" placeholder="Your email"/></div></div><div class="input-field"><label class="input-field__label" for="username">Login</label><div><input class="input-field__input form-control js-input_signup_login" type="text" name="signupLogin" placeholder="Your login"/></div></div><div class="input-field"><label class="input-field__label" for="password">Password</label><div><input class="input-field__input form-control js-input_signup_password" type="password" name="signupPassword" placeholder="Your password"/></div></div><div><button class="btn" type="submit">Sign up!</button></div></form></dd></dl></div>',e=j.length){for(d=0;e>d;d++)c=j[d],"string"==typeof c?k+=c:(f=l[c.name],f&&(k+=b(f,c.params,c.cp)));return k+i}return i}}),define("models/User",["backbone"],function(a){"use strict";var a=require("backbone"),b=a.Model.extend({defaults:{login:"",email:"",password:""},urlRoot:"api/user",sync:function(b,c,d){return"create"===b&&(b="update"),d||(d={}),d.url=this.urlRoot,arguments[0]=b,a.sync.apply(this,arguments)},validate:function(a,b){var c={};return a.login?/[^a-zA-Z0-9]/.test(a.login)&&(c.loginError="Your login must consist of only letters and digits"):c.loginError="Please, input your login",a.email?a.email.match(/^[0-9a-z-\.]+\@[0-9a-z-]{1,}\.[a-z]{2,}$/i)||(c.emailError="Please, input a valid email"):c.emailError="Please, input your email",a.password?a.password.length<5&&(c.passwordError="Your password must have more than 5 characters"):c.passwordError="Please, input your password",_.isEmpty(c)?!1:c}});return b}),define("models/Session",["backbone"],function(a){"use strict";var a=require("backbone"),b=a.Model.extend({defaults:{id:"",login:"",password:"",isLogged:!1},urlRoot:"api/session",sync:function(b,c,d){return console.log("IN THE SYNC",b),"create"===b&&(b="update"),d||(d={}),d.url=this.urlRoot,arguments[0]=b,a.sync.apply(this,arguments)},validate:function(a,b){var c={};return a.login?/[^a-zA-Z0-9]/.test(a.login)&&(c.loginError="Your login must consist of only letters and digits"):c.loginError="Please, input your login",a.password?a.password.length<5&&(c.passwordError="Your password must have more than 5 characters"):c.passwordError="Please, input your password",_.isEmpty(c)?!1:c}});return b}),define("tmpl/game",[],function(){return function(a){"use strict";function b(a,b,c){if(c)for(var d in b)"function"==typeof b[d]&&b[d].param&&(b[d]=b[d]());return a.call(h,b)}var c,d,e,f,g,h=this,i="",j=[],k="",l={};if(g="undefined"==typeof __fest_error?"undefined"!=typeof console&&console.error?function(){return Function.prototype.apply.call(console.error,console,arguments)}:function(){}:__fest_error,i+='<div class="preloader"><div class="preloader__stripe"><div class="preloader__round"><img class="preloader__logo" src="static/snake_logo.png"/></div></div><h2 class="preloader__text">Поиск соперника</h2><div class="preloader__left-curtain"></div><div class="preloader__right-curtain"></div></div><div class="main-game"><div class="main-game__main-area main main_game"><canvas class="main-game__canvas" id="gameCanvas" width="490" height="490"></canvas></div><a class="main-game__btn btn  js-btn" href="#main">Quit</a></div>',e=j.length){for(d=0;e>d;d++)c=j[d],"string"==typeof c?k+=c:(f=l[c.name],f&&(k+=b(f,c.params,c.cp)));return k+i}return i}}),define("api/eventDispatcher",["require","backbone"],function(a){"use strict";var b=a("backbone");return _.clone(b.Events)}),define("api/gameStatus",["require","backbone","api/eventDispatcher"],function(a){"use strict";var b=(a("backbone"),a("api/eventDispatcher")),c={start:"GameStart",move:"MakeMove",wait:"Wait",finish:"Finish",unexpectedEnemyExit:"EnemyExit"};return function(){return{onMessage:function(a){var d=JSON.parse(a.data);b.trigger(c[d.status],d)}}}()}),define("api/web-sockets",["require","api/gameStatus","api/eventDispatcher"],function(a){"use strict";var b=a("api/gameStatus"),c=a("api/eventDispatcher"),d=window.location.port?":":"",e=window.location.hostname+d+window.location.port;return function(){return{initConnection:function(){var a=new WebSocket("ws://"+e+"/api/gameplay");this.socket=a,this.bindEvents()},bindEvents:function(){this.currentStatus=b,this.socket.onopen=this.onOpen,this.socket.onmessage=this.currentStatus.onMessage,this.socket.onclose=this.onClose,this.socket.onerror=this.onError},onOpen:function(){console.log("Socket is opened")},onClose:function(){console.log("Socket is closed")},onError:function(){c.trigger("ConnectionFailed"),console.log("Socket has some problems")},isOpen:function(){return null!==this.socket},send:function(a){this.socket.send(JSON.stringify(a))},close:function(){try{this.socket.close()}catch(a){console.log(a.message)}}}}()}),define("models/Game/GameSession",["require","backbone","api/web-sockets","api/gameStatus","api/eventDispatcher"],function(a){"use strict";var b=a("backbone"),c=a("api/web-sockets"),d=(a("api/gameStatus"),a("api/eventDispatcher")),e=b.Model.extend({defaults:{gameFieldSize:7,myName:null,enemyName:null,color:null,red:{x:null,y:null},blue:{x:null,y:null},left:{x:null,y:null},right:{x:null,y:null},top:{x:null,y:null},bottom:{x:null,y:null},enemyMove:{x:null,y:null},win:null,isEnemyExit:!1},initialize:function(){this.listenTo(d,"GameStart",this.getInitDataForGame),this.listenTo(d,"MakeMove",this.getPossibleMove),this.listenTo(d,"Wait",this.waiting),this.listenTo(d,"Finish",this.determineWinner),this.listenTo(d,"EnemyExit",this.notifyEnemyExit)},getInitDataForGame:function(a){console.log("GameStart!"),this.set({myName:a.myName,enemyName:a.enemyName,blue:a.firstBlue,red:a.firstRed,color:a.color})},sendCoord:function(a,b){console.log("send"),c.send({x:a,y:b})},getPossibleMove:function(a){console.log("move"),this.set({left:a.left,right:a.right,top:a.top,bottom:a.bottom,enemyMove:a.enemyMove}),this.trigger("turnOnKeyboard")},waiting:function(){console.log("waiting"),this.trigger("turnOffKeyboard")},determineWinner:function(a){this.set({win:a.win}),this.trigger("Winner was determined")},notifyEnemyExit:function(a){this.set({isEnemyExit:!0}),this.trigger("isEnemyExit")}});return e}),define("views/game",["require","backbone","tmpl/game","models/Game/GameSession","models/Session","api/web-sockets","api/eventDispatcher"],function(a){"use strict";function b(a,b,c,d,e,f,g,h){a.beginPath(),a.lineWidth=h,a.strokeStyle=g,a.moveTo(b*c,b*d),a.lineTo(b*e,b*f),a.stroke()}function c(a,b,c,d,e,f,g){a.beginPath(),a.lineWidth=g,a.strokeStyle=f,a.arc(c*b,d*b,e*b,0,2*Math.PI),a.stroke()}var d,e=a("backbone"),f=a("tmpl/game"),g=a("models/Game/GameSession"),h=a("models/Session"),i=a("api/web-sockets"),j=a("api/eventDispatcher"),k=6,l=5e3,m=!1,n={red:"#FF0000",blue:"#004DFF",black:"#000000"},o={37:"left",38:"top",39:"right",40:"bottom"},p=e.View.extend({template:f,model:new g,session:new h,handleDrawInitialPoints:function(a){var b=5/d,e=5,f=this.model.get("red").x,g=this.model.get("red").y,h=this.model.get("blue").x,i=this.model.get("blue").y;c(this.canvas,d,f,g,b,n.red,e),c(this.canvas,d,h,i,b,n.blue,e)},isAuth:function(){var a=$.Deferred(),b=this;return this.session.fetch({success:function(){a.resolve()},error:function(c,d,e){401===d.status?(b.trigger("UnauthorizedUser"),a.reject()):a.resolve()}}),a.promise()},initialize:function(){_.bindAll(this,"keyAction","renderPath","handleDrawInitialPoints");var a=this;this.listenTo(this.model,"turnOnKeyboard",function(){a.drawEnemyPath(),$(document).bind("keydown",a.keyAction)}),this.listenTo(this.model,"turnOffKeyboard",function(){$(document).unbind("keydown",a.keyAction)}),this.listenTo(this.model,"EnemyExit",function(){alert("Ваш противник вышел из игры")}),this.listenTo(this.model,"Winner was determined",function(){a.model.get("win")?alert("Вы выиграли!"):alert("Вы проиграли!")}),this.listenTo(j,"ConnectionFailed",function(){alert("К сожалению связь с сервером не установлена. Вы можете сыграть в одиночную игру")}),this.listenTo(j,"GameStart",function(){m=!0,a.removePreloader(),a.handleDrawInitialPoints()})},timeCounter:function(){console.log(m);var a=this;setTimeout(function(){m||(a.removePreloader(),alert("Соперник не найден"))},l)},addPreloader:function(){$("body").removeClass("js-body_loaded")},removePreloader:function(){$("body").addClass("js-body_loaded")},render:function(){this.$el.html(this.template());var a=5,c=1,e=this.$el.find("#gameCanvas")[0],f=e.width;d=f/this.model.get("gameFieldSize"),this.canvas=e.getContext("2d"),b(this.canvas,1,0,0,f,0,n.red,a),b(this.canvas,1,0,0,0,f,n.red,a),b(this.canvas,1,0,490,f,f,n.blue,a),b(this.canvas,1,f,0,f,f,n.blue,a);for(var g=0;g<=this.model.get("gameFieldSize");g++)b(this.canvas,d,g,0,g,f,n.black,c),b(this.canvas,d,0,g,f,g,n.black,c)},drawEnemyPath:function(){var a=this.model.get("color"),c="red"===a?"blue":"red",e=this.model.get(c).x,f=this.model.get(c).y,g=this.model.get("enemyMove").x,h=this.model.get("enemyMove").y;b(this.canvas,d,e,f,g,h,n[c],k),this.model.get(c).x=this.model.get("enemyMove").x,this.model.get(c).y=this.model.get("enemyMove").y},isPossibleToMove:function(a){return-1!==this.model.get(a).x&&-1!==this.model.get(a).y},renderPath:function(a){if(this.isPossibleToMove(a)){var c=this.model.get("color"),e=this.model.get(c).x,f=this.model.get(c).y,g=this.model.get(a).x,h=this.model.get(a).y;b(this.canvas,d,e,f,g,h,n[c],k),this.model.get(c).x=this.model.get(a).x,this.model.get(c).y=this.model.get(a).y,this.model.sendCoord(this.model.get(c).x,this.model.get(c).y)}else alert("Вы не можете так идти!")},keyAction:function(a){var b=a.keyCode||a.which;this.renderPath(o[String(b)])},show:function(){this.render(),this.trigger("show",this),this.$el.show(),i.initConnection(),this.timeCounter()},hide:function(){this.addPreloader(),m=!1,$(document).unbind("keydown",this.keyAction),i.close(),this.$el.hide()}});return new p}),define("views/main",["require","backbone","tmpl/main","models/User","models/Session","views/game"],function(a){"use strict";var b=a("backbone"),c=a("tmpl/main"),d=a("models/User"),e=a("models/Session"),f=a("views/game"),g=b.View.extend({template:c,user:new d,session:new e,events:{"submit form.js-main__form_signup":"handleSignup","submit form.js-main__form_login":"handleLogin","click a.js-main__btn_logout":"handleLogout"},initialize:function(){self=this,this.user.on("invalid",function(a,b){console.log(b.emailError)}),this.session.on("invalid",function(a,b){console.log(b.passwordError),console.log(b.loginError)}),this.listenTo(f,"UnauthorizedUser",function(){alert("You need log in if you'd like to play multiplayer")}),this.session.on("change:isLogged",function(){self.session.get("isLogged")?self.viewForLoggedUser():self.viewForUnloggedUser()})},handleLogout:function(a){a.preventDefault(),this.session.set({isLogged:!1}),this.session.destroy()},viewForLoggedUser:function(){this.$(".js-signup-header").addClass("main__stripe_hidden"),this.$(".js-login-header").addClass("main__stripe_hidden"),this.$(".js-logout-header").removeClass("main__stripe_hidden")},viewForUnloggedUser:function(){this.$(".js-signup-header").removeClass("main__stripe_hidden"),this.$(".js-login-header").removeClass("main__stripe_hidden"),this.$(".js-logout-header").addClass("main__stripe_hidden")},render:function(){return this.$el.html(this.template()),this.$(".js-main__menu").on("mouseenter",".js-main__stripe",function(){$(this).next().slideDown(200).siblings(".js-main__field").slideUp(200)}),this.$(".js-main__field").filter(function(a){return 0!==a}).addClass("main__field_hidden"),this},handleSignup:function(a){a.preventDefault(),this.user.save({login:this.$(".js-input_signup_login").val(),email:this.$(".js-input_signup_email").val(),password:this.$(".js-input_signup_password").val()},{success:function(){alert("success signup")},error:function(a,b,c){403===b.status&&alert("this user already exists")}})},handleLogin:function(a){a.preventDefault();var b=this;this.session.save({login:this.$(".js-input_login_login").val(),password:this.$(".js-input_login_password").val()},{success:function(){b.session.set({isLogged:!0}),alert("success login")},error:function(a,b,c){400===b.status&&alert("this user doesn't exists"),console.log("ANOTHER ERROR")}})},show:function(){this.render(),this.trigger("show",this),this.$el.show(),this.$(".js-logout-header").addClass("main__stripe_hidden")},hide:function(){this.$el.hide(),this.$(".js-main__menu").off("mouseenter")}});return new g}),define("tmpl/scoreboard",[],function(){return function(a){"use strict";function b(a){j(a+'\nin block "'+r+'" at line: '+q+"\nfile: "+p)}function c(a){return u[a]}function d(a,b,c){if(c)for(var d in b)"function"==typeof b[d]&&b[d].param&&(b[d]=b[d]());return a.call(k,b)}function e(a){if("string"==typeof a){if(t.test(a))return a.replace(s,c)}else if("undefined"==typeof a)return"";return a;
}var f,g,h,i,j,k=this,l="",m=[],n="",o={},p="",q="",r="",s=/[&<>"]/g,t=/[&<>"]/,u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};j="undefined"==typeof __fest_error?"undefined"!=typeof console&&console.error?function(){return Function.prototype.apply.call(console.error,console,arguments)}:function(){}:__fest_error;var v=a;l+='<div class="help"></div><div class="main"><dl class="main__menu"><dt class="main__stripe js-main__stripe">ScoreBoard</dt><dd class="main__field"><ul class="scoreboard">';var w,x,y,z;try{z=v||[],y=z.length}catch(A){z=[],y=0,b(A.message)}for(w=0;y>w;w++){x=z[w],l+='<li class="scoreboard__row"><span class="scoreboard__user-login">';try{l+=x.login}catch(A){b(A.message+"15")}l+='</span><em class="scoreboard__user-score">';try{l+=e(x.score)}catch(A){b(A.message+"20")}l+='</em></li><hr class="scoreboard__border-line"/>'}if(l+='</ul><a href="#main" class="main-game__btn btn">Back</a></dd></dl></div>',h=m.length){for(g=0;h>g;g++)f=m[g],"string"==typeof f?n+=f:(i=o[f.name],i&&(n+=d(i,f.params,f.cp)));return n+l}return l}}),define("models/Score",["require","backbone"],function(a){"use strict";var b=a("backbone"),c=b.Model.extend({defaults:{id:"",login:"",score:0},urlRoot:"api/scores"});return c}),define("collections/Scores",["require","backbone","models/Score"],function(a){"use srtict";var b=a("backbone"),c=a("models/Score"),d=b.Collection.extend({model:c,url:"api/scores",comparator:function(a){return-a.get("score")}});return d}),define("views/scoreboard",["require","backbone","tmpl/scoreboard","collections/Scores"],function(a){"use strict";var b=a("backbone"),c=a("tmpl/scoreboard"),d=a("collections/Scores"),e=b.View.extend({collection:new d,template:c,initialize:function(){this.collection.bind("sync",this.render,this)},render:function(){return this.$el.html(this.template(this.collection.toJSON())),this},show:function(){this.collection.fetch(),this.render(),this.trigger("show",this),this.$el.show()},hide:function(){$(".js-btn").off("mouseenter mouseleave"),this.$el.hide()}});return new e}),define("tmpl/singleGame",[],function(){return function(a){"use strict";function b(a,b,c){if(c)for(var d in b)"function"==typeof b[d]&&b[d].param&&(b[d]=b[d]());return a.call(h,b)}var c,d,e,f,g,h=this,i="",j=[],k="",l={};if(g="undefined"==typeof __fest_error?"undefined"!=typeof console&&console.error?function(){return Function.prototype.apply.call(console.error,console,arguments)}:function(){}:__fest_error,i+='<div class="main-game"><div class="main-game__main-area main main_game"><canvas class="main-game__canvas" id="gameCanvas" width="490" height="490"></canvas></div><a class="main-game__btn btn  js-btn" id="Quit">Quit</a></div>',e=j.length){for(d=0;e>d;d++)c=j[d],"string"==typeof c?k+=c:(f=l[c.name],f&&(k+=b(f,c.params,c.cp)));return k+i}return i}}),define("models/Game/SingleGame",["require","backbone"],function(a){"use strict";var b=a("backbone"),c=b.Model.extend({defaults:{gameFieldSize:7,playerColor:"red",current:{red:{x:null,y:null},blue:{x:null,y:null}},possibilities:{red:{left:{x:null,y:null},right:{x:null,y:null},top:{x:null,y:null},bottom:{x:null,y:null}},blue:{left:{x:null,y:null},right:{x:null,y:null},top:{x:null,y:null},bottom:{x:null,y:null}}}},initialize:function(){this.occupiedPoints=window.localStorage,this.gameFieldBorderPoints={blue:[],red:[]},this.fillBorderPoints()},fillBorderPoints:function(){for(var a=0;a<=this.get("gameFieldSize");a++)this.gameFieldBorderPoints.red.push({x:a,y:this.get("gameFieldSize")}),this.gameFieldBorderPoints.blue.push({x:a,y:0}),this.gameFieldBorderPoints.red.push({x:this.get("gameFieldSize"),y:a}),this.gameFieldBorderPoints.blue.push({x:0,y:a})},pushInContainerOcuppiedPoints:function(a){var b=this.occupiedPoints.length;this.occupiedPoints.setItem(b++,JSON.stringify(a))},getNextPoint:function(a,b){var c={x:b.x+e[a].dx,y:b.y+e[a].dy};return c},isElemInArray:function(a,b){for(var c=0;c<a.length;c++)if(b.x===a[c].x&&b.y===a[c].y)return!0;return!1},isElemInLocalStorage:function(a,b){for(var c,d=0;d<a.length;d++)if(c=a.getItem(String(d)),c=JSON.parse(c),b.x===c.x&&b.y==c.y)return!0;return!1},clearLocalStorage:function(){this.occupiedPoints.clear()},getBorder:function(){return"red"===this.get("playerColor")?this.gameFieldBorderPoints.blue:"blue"===this.get("playerColor")?this.gameFieldBorderPoints.red:void 0},isPossibleToMove:function(a){var b=0<=a.x<=this.get("gameFieldSize"),c=0<=a.y<=this.get("gameFieldSize"),d=this.isElemInLocalStorage(this.occupiedPoints,a),e=this.isElemInArray(this.getBorder(),a);return b&&c&&d!==!0&&e!==!0},getPossibleMove:function(a){for(var b=["left","top","right","bottom"],c=0;c<b.length;c++){var e=this.getNextPoint(b[c],a);this.isPossibleToMove(e)?this.get("possibilities")[this.get("playerColor")][b[c]]=e:this.get("possibilities")[this.get("playerColor")][b[c]]=d}},getOccupiedPointsFromStorageByColor:function(a){for(var b=[],c="red"===a?0:1;c<this.occupiedPoints.length;c+=2)b.push(JSON.parse(this.occupiedPoints.getItem(c)));return b}}),d={x:-1,y:-1},e={left:{dx:-1,dy:0},top:{dx:0,dy:-1},right:{dx:1,dy:0},bottom:{dx:0,dy:1}};return c}),define("views/singleGame",["require","backbone","tmpl/singleGame","models/Game/SingleGame"],function(a){"use strict";function b(a,b,c){var d=Math.floor(Math.random()*(b-a+1))+a;if(c){for(;d===c;)d=Math.floor(Math.random()*(b-a+1))+a;return d}return d}function c(a,b,c,d,e,f,g,h){a.beginPath(),a.lineWidth=h,a.strokeStyle=g,a.moveTo(b*c,b*d),a.lineTo(b*e,b*f),a.stroke()}function d(a,b,c,d,e,f,g){a.beginPath(),a.lineWidth=g,a.strokeStyle=f,a.arc(c*b,d*b,e*b,0,2*Math.PI),a.stroke()}var e,f=a("backbone"),g=a("tmpl/singleGame"),h=a("models/Game/SingleGame"),i=6,j={red:"#FF0000",blue:"#004DFF",black:"#000000"},k={37:"left",38:"top",39:"right",40:"bottom"},l=f.View.extend({template:g,model:new h,events:{"click #Quit":"handleQuit"},handleQuit:function(){this.model.clearLocalStorage(),this.trigger("QuitTheSingleGame")},drawInitialPoints:function(){var a=5/e,b=5,c=this.model.get("current").red.x,f=this.model.get("current").red.y,g=this.model.get("current").blue.x,h=this.model.get("current").blue.y;d(this.canvas,e,c,f,a,j.red,b),d(this.canvas,e,g,h,a,j.blue,b)},defineRandomInitialPoints:function(){var a=this.model.get("gameFieldSize"),c={x:b(1,a-1),y:b(1,a-1)},d={x:b(1,a-1,c.x),y:b(1,a-1,c.y)},e={red:c,blue:d};return e},initialize:function(){_.bindAll(this,"keyAction","renderPath"),this.isUserRefreshedThePage=!1},resumeGameAfterPageReload:function(){var a=this.model.getOccupiedPointsFromStorageByColor("red"),b=this.model.getOccupiedPointsFromStorageByColor("blue");this.resetDrawPoints(a,"red"),this.resetDrawPoints(b,"blue"),this.model.get("current").red=a[a.length-1],this.model.get("current").blue=b[b.length-1]},resetDrawPoints:function(a,b){var f,g,h=5/e,j=5,k=a[0].x,l=a[0].y;d(this.canvas,e,k,l,h,b,j);for(var m=0;m<a.length-1;m++)k=a[m].x,l=a[m].y,f=a[m+1].x,g=a[m+1].y,c(this.canvas,e,k,l,f,g,b,i)},render:function(){this.$el.html(this.template());var a=5,b=1,d=this.$el.find("#gameCanvas")[0],f=d.width;e=f/this.model.get("gameFieldSize"),this.canvas=d.getContext("2d"),c(this.canvas,1,0,0,f,0,j.red,a),c(this.canvas,1,0,0,0,f,j.red,a),c(this.canvas,1,0,490,f,f,j.blue,a),c(this.canvas,1,f,0,f,f,j.blue,a);for(var g=0;g<=this.model.get("gameFieldSize");g++)c(this.canvas,e,g,0,g,f,j.black,b),c(this.canvas,e,0,g,f,g,j.black,b)},determinePossibleEnemyState:function(){for(var a=["left","top","right","bottom"],c=[],d=0;d<a.length;d++)this.isPossibleToMove(a[d],"blue")&&c.push(a[d]);if(0===c.length)return null;var e=b(0,c.length-1);return c[e]},drawEnemyPath:function(){this.model.set({playerColor:"blue"}),this.model.getPossibleMove(this.model.get("current").blue);var a=this.determinePossibleEnemyState();if(null===a)alert("Вы выиграли!");else{var b=this.model.get("current").blue.x,d=this.model.get("current").blue.y,f=this.model.get("possibilities").blue[a].x,g=this.model.get("possibilities").blue[a].y;c(this.canvas,e,b,d,f,g,j.blue,i),this.model.get("current").blue=this.model.get("possibilities").blue[a],this.model.pushInContainerOcuppiedPoints(this.model.get("current").blue)}$(document).bind("keydown",this.keyAction)},isFinishGame:function(a){for(var b=["left","top","right","bottom"],c=0;c<b.length;c++)if(this.isPossibleToMove(b[c],a))return!1;return!0},isPossibleToMove:function(a,b){return-1!==this.model.get("possibilities")[b][a].x&&-1!==this.model.get("possibilities")[b][a].y},renderPath:function(a){if(this.model.set({playerColor:"red"}),this.model.getPossibleMove(this.model.get("current").red),this.isFinishGame("red"))alert("Вы проиграли");else if(this.isPossibleToMove(a,"red")){var b=this.model.get("current").red.x,d=this.model.get("current").red.y,f=this.model.get("possibilities").red[a].x,g=this.model.get("possibilities").red[a].y;c(this.canvas,e,b,d,f,g,j.red,i),this.model.get("current").red=this.model.get("possibilities").red[a],this.model.pushInContainerOcuppiedPoints(this.model.get("current").red),$(document).unbind("keydown",this.keyAction),this.drawEnemyPath()}else alert("Вы не можете так идти!")},keyAction:function(a){var b=a.keyCode||a.which;this.renderPath(k[String(b)])},getInitialPoints:function(){this.model.set({current:this.defineRandomInitialPoints()}),this.model.pushInContainerOcuppiedPoints(this.model.get("current").red),this.model.pushInContainerOcuppiedPoints(this.model.get("current").blue)},show:function(a){this.isUserRefreshedThePage=a===window.location.href,this.render(),this.trigger("show",this),this.$el.show(),this.isUserRefreshedThePage?this.resumeGameAfterPageReload():(this.getInitialPoints(),this.drawInitialPoints()),$(document).bind("keydown",this.keyAction)},hide:function(){$(document).unbind("keydown",this.keyAction),this.$el.hide()}});return new l}),define("router",["require","backbone","views/viewManager","views/main","views/scoreboard","views/game","views/main","views/singleGame"],function(a){"use strict";var b=a("backbone"),c=a("views/viewManager"),d=a("views/main"),e=a("views/scoreboard"),f=a("views/game"),d=a("views/main"),g=a("views/singleGame"),h=window.sessionStorage;c.addViews([d,e,f,g]);var i=b.Router.extend({routes:{main:"concreteAction",scoreboard:"concreteAction",game:"gameAction",singleGame:"singleGameAction","*default":"defaultAction"},initialize:function(){var a=this;return b.history.start(),this.listenTo(g,"QuitTheSingleGame",function(){a.navigate("main",{trigger:!0})}),this},gameAction:function(){var a=this;f.isAuth().done(function(){h.setItem(h.length+1,window.location.href),f.show()}).fail(function(){a.navigate("main")})},concreteAction:function(){h.setItem(h.length+1,window.location.href);var c=a("views/"+b.history.getFragment());c.show()},singleGameAction:function(){h.setItem(h.length+1,window.location.href);var a=h.getItem(h.length-1);g.show(a)},defaultAction:function(){h.setItem(h.length+1,window.location.href),d.show()}});return new i}),require.config({baseUrl:"js",paths:{jquery:["https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min","lib/jquery"],underscore:["https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min","lib/underscore"],backbone:["https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone-min","lib/backbone"],bootstrap:["https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min","lib/bootstrap"]},shim:{backbone:{deps:["underscore","jquery"],exports:"Backbone"},underscore:{exports:"_"},bootstrap:{deps:["jquery"]}}}),require(["bootstrap","router"]),define("main",function(){});